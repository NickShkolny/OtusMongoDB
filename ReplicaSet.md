Конечно! Вот инструкция по созданию шардированного кластера MongoDB в формате Markdown:

---

## Шаги по созданию шардированного кластера MongoDB

### 1. Установка MongoDB на VDS серверы

Установите MongoDB на каждом из трех VDS серверов. Вы можете использовать пакетный менеджер вашей операционной системы или скачать MongoDB с официального сайта.

Запустите MongoDB на каждом сервере с помощью команды `mongod`. Укажите параметры, такие как путь к данным, порт, IP-адрес и другие настройки.

### 2. Создание конфиг-сервера (Config Server Replica Set)

1. Создайте три папки для представления конфиг-серверов (например, `cfg1`, `cfg2`, `cfg3`).
2. Запустите каждый инстанс конфиг-сервера. Укажите настройки для каждого `mongod` через конфигурационный файл или командную строку.
3. Подключитесь к одному из конфиг-серверов с помощью `mongosh`:
    ```bash
    mongosh --host cfg1.example.net --port <port>
    ```
4. Инициируйте реплика-сет конфиг-сервера с помощью метода `rs.initiate()`. В конфигурационном документе реплика-сета укажите:
    - `_id` — имя реплика-сета, заданное в параметре `replication.replSetName` или `--replSet`.
    - `configsvr: true` — для реплика-сета конфиг-сервера.
    - `members` — массив документов для каждого участника реплика-сета.

### 3. Запуск `mongos` для шардированного кластера

1. Запустите `mongos`, указав конфиг-серверы через конфигурационный файл или параметр командной строки.
2. Теперь ваш шардированный кластер состоит из `mongos` и конфиг-серверов. Вы можете подключиться к нему с помощью `mongosh`.

### 4. Создание шардов (Shard Replica Sets)

1. Создайте три папки для представления шардов (например, `shard1`, `shard2`, `shard3`).
2. Запустите каждый инстанс шарда. Укажите настройки для каждого `mongod`.
3. Инициируйте реплика-сет для каждого шарда, аналогично тому, как мы делали для конфиг-сервера.

### 5. Добавление баз данных и коллекций на шарды

1. Создайте базы данных и коллекции, которые вы хотите шардировать.
2. Используйте метод `sh.shardCollection()` для шардирования коллекции. Выберите хороший ключ шардирования, например, уникальный и равномерно распределенный ключ.

### 6. Балансировка данных

MongoDB автоматически балансирует данные между шардами. Вы можете следить за процессом балансировки с помощью команды `sh.status()`.

### 7. Настройка аутентификации и многоролевого доступа

1. Настройте аутентификацию и авторизацию в MongoDB, используя x.509 или другие методы.
2. Создайте роли и назначьте их пользователям для обеспечения многоролевого доступа.

Удачи в настройке вашего шардированного кластера MongoDB! Если у вас возникн